From 8a98ae9d046cc405a30be831e2918e66d017fcc7 Mon Sep 17 00:00:00 2001
From: Workers DevProd <workers-devprod@cloudflare.com>
Date: Mon, 2 Oct 2023 18:13:34 +0100
Subject: [PATCH 01/15] Support viewing files over the network

---
 front_end/core/sdk/Target.ts             |  4 ++++
 front_end/entrypoints/js_app/js_app.ts   |  2 +-
 front_end/panels/sources/sources-meta.ts | 11 ++++++++---
 tsconfig.json                            |  3 ++-
 4 files changed, 15 insertions(+), 5 deletions(-)

diff --git a/front_end/core/sdk/Target.ts b/front_end/core/sdk/Target.ts
index f5f812b001..76b67ea20b 100644
--- a/front_end/core/sdk/Target.ts
+++ b/front_end/core/sdk/Target.ts
@@ -85,6 +85,9 @@ export class Target extends ProtocolClient.InspectorBackend.TargetBase {
       case Type.TAB:
         this.#capabilitiesMask = Capability.TARGET | Capability.TRACING;
         break;
+      case Type.CLOUDFLARE:
+        this.#capabilitiesMask = Capability.JS | Capability.NETWORK;
+        break;
     }
     this.#typeInternal = type;
     this.#parentTargetInternal = parentTarget;
@@ -259,6 +262,7 @@ export enum Type {
   AUCTION_WORKLET = 'auction-worklet',
   WORKLET = 'worklet',
   TAB = 'tab',
+  CLOUDFLARE = 'cloudflare',
 }

 export const enum Capability {
diff --git a/front_end/entrypoints/js_app/js_app.ts b/front_end/entrypoints/js_app/js_app.ts
index 45028f436a..39a4b237b7 100644
--- a/front_end/entrypoints/js_app/js_app.ts
+++ b/front_end/entrypoints/js_app/js_app.ts
@@ -57,7 +57,7 @@ export class JsMainImpl implements Common.Runnable.Runnable {
     Host.userMetrics.actionTaken(Host.UserMetrics.Action.ConnectToNodeJSDirectly);
     void SDK.Connections.initMainConnection(async () => {
       const target = SDK.TargetManager.TargetManager.instance().createTarget(
-          'main', i18nString(UIStrings.main), SDK.Target.Type.NODE, null);
+          'main', i18nString(UIStrings.main), SDK.Target.Type.CLOUDFLARE, null);
       void target.runtimeAgent().invoke_runIfWaitingForDebugger();
     }, Components.TargetDetachedDialog.TargetDetachedDialog.webSocketConnectionLost);
   }
diff --git a/front_end/panels/sources/sources-meta.ts b/front_end/panels/sources/sources-meta.ts
index 42a2e17f07..9713c169a0 100644
--- a/front_end/panels/sources/sources-meta.ts
+++ b/front_end/panels/sources/sources-meta.ts
@@ -40,6 +40,11 @@ const UIStrings = {
    *@description Title of the 'Snippets' tool in the Snippets Navigator View, which is part of the Sources tool
    */
   snippets: 'Snippets',
+  /**
+  *@description Title of the 'Cloudflare' tool in the Cloudflare Navigator View, which is part of the Sources tool
+  */
+  cloudflare: 'Cloudflare',
+  /**
   /**
    *@description Command for showing the 'Search' tool
    */
@@ -497,14 +502,14 @@ UI.ViewManager.registerViewExtension({

 UI.ViewManager.registerViewExtension({
   location: UI.ViewManager.ViewLocationValues.NAVIGATOR_VIEW,
-  id: 'navigator-files',
+  id: 'navigator-network',
   commandPrompt: i18nLazyString(UIStrings.showWorkspace),
-  title: i18nLazyString(UIStrings.workspace),
+  title: i18nLazyString(UIStrings.cloudflare),
   order: 3,
   persistence: UI.ViewManager.ViewPersistence.PERMANENT,
   async loadView() {
     const Sources = await loadSourcesModule();
-    return new Sources.SourcesNavigator.FilesNavigatorView();
+    return Sources.SourcesNavigator.NetworkNavigatorView.instance();
   },
 });

diff --git a/tsconfig.json b/tsconfig.json
index b3be02e26b..811051314d 100644
--- a/tsconfig.json
+++ b/tsconfig.json
@@ -17,6 +17,7 @@
     "inspector_overlay"
   ],
   "exclude": [
-    "front_end/**/*-legacy.ts"
+    "front_end/**/*-legacy.ts",
+    "third_party/**/*.ts"
   ]
 }
--
2.39.5 (Apple Git-154)

